---
import Layout from "../../layouts/Layout.astro";
import { getCollection } from "astro:content";

const content = (await getCollection("til"))
  .sort(
    (a, b) => new Date(b.data.date).valueOf() - new Date(a.data.date).valueOf(),
  )
  .map((entry) => ({
    ...entry,
    slug: entry.filePath?.split("/").pop()?.split(".")[0],
  }));
---

<Layout title="monody's til">
  <div class="container px-3 py-24">
    <div>
      <h1 class="text-3xl font-instrument-serif">
        Which days are the strongest? — <em data-answer>Saturday and Sunday</em>
      </h1>
      <p data-answer>
        The rest are <em>weekdays</em>.
      </p>
    </div>
    <div class="pt-12">
      <ul class="space-y-4">
        {
          content.map((entry) => (
            <li class="border-b border-border pb-4">
              <a href={`/til/${entry.slug}`} data-astro-prefetch>
                <span class="text-subtle text-sm" transition:name="til_date">
                  {entry.data.date} —
                </span>
                <h2 class="font-medium font-serif" transition:name="til_title">
                  {entry.data.title}
                </h2>
              </a>
            </li>
          ))
        }
      </ul>
    </div>
  </div>
</Layout>

<style scoped>
  [data-answer] {
    filter: blur(8px);
    transition: filter 200ms ease;
  }

  [data-answer]:not(.revealed) {
    cursor: pointer;
    user-select: none;
  }

  [data-answer].revealed {
    filter: blur(0);
  }
</style>

<script>
  document.querySelectorAll("[data-answer]").forEach((element) => {
    element.addEventListener("click", () => {
      document.querySelectorAll("[data-answer]").forEach((el) => {
        el.classList.toggle("revealed", true);
      });
    });
  });
</script>
