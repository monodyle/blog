---
import Layout from "../../layouts/Layout.astro";
import { getCollection } from "astro:content";

const content = (await getCollection("blog"))
  .sort((a, b) => new Date(b.data.date).valueOf() - new Date(a.data.date).valueOf())
  .map((post) => ({
    ...post,
    slug: post.filePath?.split("/").pop()?.split(".")[0],
    date: new Date(post.data.date).toLocaleDateString("en-US", {
      year: "numeric",
      month: "long",
      day: "numeric",
    }),
  }));
---

<Layout>
  <div class="container px-3 py-16">
    <div class="py-12">
      <h1 class="text-4xl font-instrument-serif">
        The <em>things</em> I think...
      </h1>
    </div>

    <ul>
      {
        content.map((post) => (
          <li class="py-4">
            <span class="text-subtle text-xs">
              {post.date}
            </span>
            <h2 class="text-2xl font-serif">
              <a href={`/blog/${post.slug}`}>{post.data.title}</a>
            </h2>
            <p class="text-subtle">{post.data.excerpt}</p>
          </li>
        ))
      }
    </ul>
  </div>
</Layout>
